

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>data &mdash; DI-drive 0.3.4 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="eval" href="eval.html" />
    <link rel="prev" title="models" href="models.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> DI-drive
          

          
          </a>

          
            
            
              <div class="version">
                0.3.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../features/index.html">Features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../model_zoo/index.html">Model Zoo</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Doc</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="simulators.html">simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="envs.html">envs</a></li>
<li class="toctree-l2"><a class="reference internal" href="policy.html">policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html">models</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#carlabenchmarkcollector">CarlaBenchmarkCollector</a></li>
<li class="toctree-l3"><a class="reference internal" href="#benchmarkdatasetsaver">BenchmarkDatasetSaver</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="eval.html">eval</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">utils</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DI-drive</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">API Doc</a> &raquo;</li>
        
      <li>data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api_doc/data.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="data">
<h1>data<a class="headerlink" href="#data" title="Permalink to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<section id="carlabenchmarkcollector">
<h2>CarlaBenchmarkCollector<a class="headerlink" href="#carlabenchmarkcollector" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.data.carla_benchmark_collector.CarlaBenchmarkCollector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.data.carla_benchmark_collector.</span></span><span class="sig-name descname"><span class="pre">CarlaBenchmarkCollector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseEnvManager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/data/carla_benchmark_collector.html#CarlaBenchmarkCollector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.data.carla_benchmark_collector.CarlaBenchmarkCollector" title="Permalink to this definition">¶</a></dt>
<dd><p>Collector to collect Carla benchmark data with envs. It uses several environments in <code class="docutils literal notranslate"><span class="pre">EnvManager</span></code> to
collect data. It will automatically get params to reset environments. For every suite provided by user,
collector will find all available reset params from benchmark files and store them in a list. When
collecting data, the collector will collect each suite in average and store the index of each suite,
to make sure each reset param is collected once and only once. The collected data are stored in a
trajectory list, with observations, actions and reset param of the episode.</p>
<dl class="simple">
<dt>Note:</dt><dd><p>Env manager must run WITHOUT auto reset.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>cfg (Dict): Config dict.</p></li>
<li><p>env (BaseEnvManager): Env manager used to collect data.</p></li>
<li><p>policy (Any): Policy used to collect data. Must have <code class="docutils literal notranslate"><span class="pre">forward</span></code> method.</p></li>
</ul>
</dd>
<dt class="field-even">Interfaces<span class="colon">:</span></dt>
<dd class="field-even"><p>reset, collect, close</p>
</dd>
<dt class="field-odd">Properties<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>env (BaseEnvManager): Env manager with several environments used to sample data.</p></li>
<li><p>policy (Any): Policy instance to interact with envs.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="core.data.carla_benchmark_collector.CarlaBenchmarkCollector.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/core/data/carla_benchmark_collector.html#CarlaBenchmarkCollector.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.data.carla_benchmark_collector.CarlaBenchmarkCollector.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close collector and env manager if not closed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.data.carla_benchmark_collector.CarlaBenchmarkCollector.collect">
<span class="sig-name descname"><span class="pre">collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_episode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span></span></span><a class="reference internal" href="../_modules/core/data/carla_benchmark_collector.html#CarlaBenchmarkCollector.collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.data.carla_benchmark_collector.CarlaBenchmarkCollector.collect" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect data from policy and env manager. It will collect each benchmark suite in average
according to ‘n_episode’.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>n_episode (int): Num of episodes to collect.</p></li>
<li><p>policy_kwargs (Dict, optional): Additional arguments in policy forward. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List: List of collected data. Each elem stores an episode trajectory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.data.carla_benchmark_collector.CarlaBenchmarkCollector.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">suite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/core/data/carla_benchmark_collector.html#CarlaBenchmarkCollector.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.data.carla_benchmark_collector.CarlaBenchmarkCollector.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset collector and policies. Clear data cache storing data trajectories. If ‘suite’ is provided
in arguments, the collector will change its collected suites and generate reset params again.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>suite (Union[List, str], optional): Collected suites after reset. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="benchmarkdatasetsaver">
<h2>BenchmarkDatasetSaver<a class="headerlink" href="#benchmarkdatasetsaver" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.data.benchmark_dataset_saver.BenchmarkDatasetSaver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.data.benchmark_dataset_saver.</span></span><span class="sig-name descname"><span class="pre">BenchmarkDatasetSaver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_process_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmdb_obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['lidar',</span> <span class="pre">'birdview']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/data/benchmark_dataset_saver.html#BenchmarkDatasetSaver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.data.benchmark_dataset_saver.BenchmarkDatasetSaver" title="Permalink to this definition">¶</a></dt>
<dd><p>Benchmark dataset saver in DI-drive. It can save dataset in standard benchmark dataset form
defined in DI-drive. User can pass a post-process function to specialize ‘sensor_data’ and
‘others’ saved in dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>save_dir (str): Dataset folder path.</p></li>
<li><p>obs_cfg (Dict): Observation config dict in simulator.</p></li>
<li><p>post_process_fn (Callable, optional): Post-process function defined by user. Defaults to None.</p></li>
<li><p>lmdb_obs (List, optional): Observation types that saved as lmdb rather than image, default to [‘lidar’, ‘bev’]</p></li>
</ul>
</dd>
<dt class="field-even">Interfaces<span class="colon">:</span></dt>
<dd class="field-even"><p>make_dataset_path, save_episodes_data, make_index</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="core.data.benchmark_dataset_saver.BenchmarkDatasetSaver.make_dataset_path">
<span class="sig-name descname"><span class="pre">make_dataset_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_metainfo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/core/data/benchmark_dataset_saver.html#BenchmarkDatasetSaver.make_dataset_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.data.benchmark_dataset_saver.BenchmarkDatasetSaver.make_dataset_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Make dataset folder and write dataset meta infomation into a json file.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>dataset_metainfo (Dict): the metainfo of datasets</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.data.benchmark_dataset_saver.BenchmarkDatasetSaver.make_index">
<span class="sig-name descname"><span class="pre">make_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">command_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/core/data/benchmark_dataset_saver.html#BenchmarkDatasetSaver.make_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.data.benchmark_dataset_saver.BenchmarkDatasetSaver.make_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Make an index txt file to save all the command of each frame in dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>command_index (int, optional): The index of command in ‘measurements.lmdb’. Defaults to 11.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.data.benchmark_dataset_saver.BenchmarkDatasetSaver.save_episodes_data">
<span class="sig-name descname"><span class="pre">save_episodes_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">episodes_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_episode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/core/data/benchmark_dataset_saver.html#BenchmarkDatasetSaver.save_episodes_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.data.benchmark_dataset_saver.BenchmarkDatasetSaver.save_episodes_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data from several episodes sampled from collector, with ‘env_param’ and ‘data’ key
saved in each episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>episode_count (int): Start count of episode to save.</p></li>
<li><p>episodes_data (List): Saved data of episodes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="eval.html" class="btn btn-neutral float-right" title="eval" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="models.html" class="btn btn-neutral float-left" title="models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, OpenDILab

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>