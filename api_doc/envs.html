

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>envs &mdash; DI-drive 0.3.4 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="policy" href="policy.html" />
    <link rel="prev" title="simulators" href="simulators.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> DI-drive
          

          
          </a>

          
            
            
              <div class="version">
                0.3.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../features/index.html">Features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../model_zoo/index.html">Model Zoo</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Doc</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="simulators.html">simulators</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">envs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basedriveenv">BaseDriveEnv</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.envs.BaseDriveEnv"><code class="docutils literal notranslate"><span class="pre">BaseDriveEnv</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#simplecarlaenv">SimpleCarlaEnv</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.envs.SimpleCarlaEnv"><code class="docutils literal notranslate"><span class="pre">SimpleCarlaEnv</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#scenariocarlaenv">ScenarioCarlaEnv</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.envs.ScenarioCarlaEnv"><code class="docutils literal notranslate"><span class="pre">ScenarioCarlaEnv</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#metadrivemacroenv">MetaDriveMacroEnv</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.envs.MetaDriveMacroEnv"><code class="docutils literal notranslate"><span class="pre">MetaDriveMacroEnv</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#metadrivetrajenv">MetaDriveTrajEnv</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.envs.MetaDriveTrajEnv"><code class="docutils literal notranslate"><span class="pre">MetaDriveTrajEnv</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#driveenvwrapper">DriveEnvWrapper</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.envs.DriveEnvWrapper"><code class="docutils literal notranslate"><span class="pre">DriveEnvWrapper</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#benchmarkenvwrapper">BenchmarkEnvWrapper</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.envs.BenchmarkEnvWrapper"><code class="docutils literal notranslate"><span class="pre">BenchmarkEnvWrapper</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="policy.html">policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html">models</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">data</a></li>
<li class="toctree-l2"><a class="reference internal" href="eval.html">eval</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">utils</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DI-drive</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">API Doc</a> &raquo;</li>
        
      <li>envs</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api_doc/envs.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="envs">
<h1>envs<a class="headerlink" href="#envs" title="Permalink to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<section id="basedriveenv">
<h2>BaseDriveEnv<a class="headerlink" href="#basedriveenv" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.envs.BaseDriveEnv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.envs.</span></span><span class="sig-name descname"><span class="pre">BaseDriveEnv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/envs/base_drive_env.html#BaseDriveEnv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.BaseDriveEnv" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for environments. It is inherited from <cite>gym.Env</cite> and uses the same interfaces.
All Drive Env class is supposed to inherit from this class.</p>
<dl class="simple">
<dt>Note:</dt><dd><p>To run Reinforcement Learning on DI-engine platform, the environment should be wrapped with <cite>DingEnvWrapper</cite>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>cfg (Dict): Config Dict.</p></li>
</ul>
</dd>
<dt class="field-even">Interfaces<span class="colon">:</span></dt>
<dd class="field-even"><p>reset, step, close, seed</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="core.envs.BaseDriveEnv.close">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/core/envs/base_drive_env.html#BaseDriveEnv.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.BaseDriveEnv.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Release all resources in environment and close.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.BaseDriveEnv.reset">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/core/envs/base_drive_env.html#BaseDriveEnv.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.BaseDriveEnv.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset current environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.BaseDriveEnv.seed">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/core/envs/base_drive_env.html#BaseDriveEnv.seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.BaseDriveEnv.seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Set random seed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.BaseDriveEnv.step">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/core/envs/base_drive_env.html#BaseDriveEnv.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.BaseDriveEnv.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Run one step of the environment and return the observation dict.</p>
</dd></dl>

</dd></dl>

</section>
<section id="simplecarlaenv">
<h2>SimpleCarlaEnv<a class="headerlink" href="#simplecarlaenv" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.envs.SimpleCarlaEnv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.envs.</span></span><span class="sig-name descname"><span class="pre">SimpleCarlaEnv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'localhost'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">9000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tm_port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">carla_timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">60.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/envs/simple_carla_env.html#SimpleCarlaEnv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.SimpleCarlaEnv" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple deployment of Carla Environment with single hero vehicle. It use <code class="docutils literal notranslate"><span class="pre">CarlaSimulator</span></code> to interact with
Carla server and gets running status. The observation is obtained from simulator’s state, information and
sensor data, along with reward which can be calculated and retrived.</p>
<p>When created, it will initialize environment with config and Carla TCP host &amp; port. This method will NOT create
simulator instance. It only creates some data structures to store information when running env.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>cfg (Dict): Env config dict.</p></li>
<li><p>host (str, optional): Carla server IP host. Defaults to ‘localhost’.</p></li>
<li><p>port (int, optional): Carla server IP port. Defaults to 9000.</p></li>
<li><p>tm_port (Optional[int], optional): Carla Traffic Manager port. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Interfaces<span class="colon">:</span></dt>
<dd class="field-even"><p>reset, step, close, is_success, is_failure, render, seed</p>
</dd>
<dt class="field-odd">Properties<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>hero_player (carla.Actor): Hero vehicle in simulator.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="core.envs.SimpleCarlaEnv.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/core/envs/simple_carla_env.html#SimpleCarlaEnv.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.SimpleCarlaEnv.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete simulator &amp; visualizer instances and close the environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.SimpleCarlaEnv.compute_reward">
<span class="sig-name descname"><span class="pre">compute_reward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/core/envs/simple_carla_env.html#SimpleCarlaEnv.compute_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.SimpleCarlaEnv.compute_reward" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute reward for current frame, with details returned in a dict. In short, in contains goal reward,
route following reward calculated by route length in current and last frame, some navigation attitude reward
with respective to target waypoint, and failure reward by checking each failure event.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[float, Dict]: Total reward value and detail for each value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.SimpleCarlaEnv.get_observations">
<span class="sig-name descname"><span class="pre">get_observations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../_modules/core/envs/simple_carla_env.html#SimpleCarlaEnv.get_observations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.SimpleCarlaEnv.get_observations" title="Permalink to this definition">¶</a></dt>
<dd><p>Get observations from simulator. The sensor data, navigation, state and information in simulator
are used, while not all these are added into observation dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict: Observation dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.SimpleCarlaEnv.is_failure">
<span class="sig-name descname"><span class="pre">is_failure</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/core/envs/simple_carla_env.html#SimpleCarlaEnv.is_failure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.SimpleCarlaEnv.is_failure" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if env fails. colliding, being stuck, running light, running off road, running in
wrong direction according to config. It will certainly happen when time is out.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool: Whether failure.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.SimpleCarlaEnv.is_success">
<span class="sig-name descname"><span class="pre">is_success</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/core/envs/simple_carla_env.html#SimpleCarlaEnv.is_success"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.SimpleCarlaEnv.is_success" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the task succeed. It only happens when hero vehicle is close to target waypoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool: Whether success.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.SimpleCarlaEnv.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../_modules/core/envs/simple_carla_env.html#SimpleCarlaEnv.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.SimpleCarlaEnv.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset environment to start a new episode, with provided reset params. If there is no simulator, this method will
create a new simulator instance. The reset param is sent to simulator’s <code class="docutils literal notranslate"><span class="pre">init</span></code> method to reset simulator,
then reset all statues recording running states, and create a visualizer if needed. It returns the first frame
observation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict: The initial observation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.SimpleCarlaEnv.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/core/envs/simple_carla_env.html#SimpleCarlaEnv.seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.SimpleCarlaEnv.seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Set random seed for environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>seed (int): Random seed value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.SimpleCarlaEnv.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/core/envs/simple_carla_env.html#SimpleCarlaEnv.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.SimpleCarlaEnv.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Run one time step of environment, get observation from simulator and calculate reward. The environment will
be set to ‘done’ only at success or failure. And if so, all visualizers will end. Its interfaces follow
the standard definition of <code class="docutils literal notranslate"><span class="pre">gym.Env</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>action (Dict): Action provided by policy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[Any, float, bool, Dict]: A tuple contains observation, reward, done and information.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="scenariocarlaenv">
<h2>ScenarioCarlaEnv<a class="headerlink" href="#scenariocarlaenv" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.envs.ScenarioCarlaEnv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.envs.</span></span><span class="sig-name descname"><span class="pre">ScenarioCarlaEnv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">host</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'localhost'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tm_port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/envs/scenario_carla_env.html#ScenarioCarlaEnv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.ScenarioCarlaEnv" title="Permalink to this definition">¶</a></dt>
<dd><p>Carla Scenario Environment with a single hero vehicle. It uses <code class="docutils literal notranslate"><span class="pre">CarlaScenarioSimulator</span></code> to load scenario
configurations and interacts with Carla server to get running status. The Env is initialized with a scenario
config, which could be a route with scenarios or a single scenario. The observation, sensor settings and visualizer
are the same with <cite>SimpleCarlaEnv</cite>. The reward is derived based on the scenario criteria in each tick. The criteria
is also related to success and failure judgement which is used to end an episode.</p>
<p>When created, it will initialize environment with config and Carla TCP host &amp; port. This method will NOT create
the simulator instance. It only creates some data structures to store information when running env.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>cfg (Dict): Env config dict.</p></li>
<li><p>host (str, optional): Carla server IP host. Defaults to ‘localhost’.</p></li>
<li><p>port (int, optional): Carla server IP port. Defaults to 9000.</p></li>
<li><p>tm_port (Optional[int], optional): Carla Traffic Manager port. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Interfaces<span class="colon">:</span></dt>
<dd class="field-even"><p>reset, step, close, is_success, is_failure, render, seed</p>
</dd>
<dt class="field-odd">Properties<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>hero_player (carla.Actor): Hero vehicle in simulator.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="core.envs.ScenarioCarlaEnv.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/envs/scenario_carla_env.html#ScenarioCarlaEnv.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.ScenarioCarlaEnv.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete simulator &amp; visualizer instances and close environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.ScenarioCarlaEnv.compute_reward">
<span class="sig-name descname"><span class="pre">compute_reward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/envs/scenario_carla_env.html#ScenarioCarlaEnv.compute_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.ScenarioCarlaEnv.compute_reward" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute reward for current frame, and return details in a dict. In short, it contains goal reward,
route following reward calculated by criteria in current and last frame, and failure reward by checking criteria
in each frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[float, Dict]: Total reward value and detail for each value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.ScenarioCarlaEnv.get_observations">
<span class="sig-name descname"><span class="pre">get_observations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/envs/scenario_carla_env.html#ScenarioCarlaEnv.get_observations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.ScenarioCarlaEnv.get_observations" title="Permalink to this definition">¶</a></dt>
<dd><p>Get observations from simulator. The sensor data, navigation, state and information in simulator
are used, while not all these are added into observation dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict: Observation dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.ScenarioCarlaEnv.is_failure">
<span class="sig-name descname"><span class="pre">is_failure</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/core/envs/scenario_carla_env.html#ScenarioCarlaEnv.is_failure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.ScenarioCarlaEnv.is_failure" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the task fails. It may happen when behavior tree ends unsuccessfully or some criteria trigger.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool: Whether failure.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.ScenarioCarlaEnv.is_success">
<span class="sig-name descname"><span class="pre">is_success</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/core/envs/scenario_carla_env.html#ScenarioCarlaEnv.is_success"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.ScenarioCarlaEnv.is_success" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the task succeed. It only happens when behavior tree ends successfully.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool: Whether success.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.ScenarioCarlaEnv.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../_modules/core/envs/scenario_carla_env.html#ScenarioCarlaEnv.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.ScenarioCarlaEnv.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset environment to start a new episode, with provided reset params. If there is no simulator, this method will
create a new simulator instance. The reset param is sent to simulator’s <code class="docutils literal notranslate"><span class="pre">init</span></code> method to reset simulator,
then reset all statues recording running states, and create a visualizer if needed. It returns the first frame
observation.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>config (Any): Configuration instance of the scenario</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict: The initial observation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.ScenarioCarlaEnv.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/core/envs/scenario_carla_env.html#ScenarioCarlaEnv.seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.ScenarioCarlaEnv.seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Set random seed for environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>seed (int): Random seed value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.ScenarioCarlaEnv.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/envs/scenario_carla_env.html#ScenarioCarlaEnv.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.ScenarioCarlaEnv.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Run one time step of environment, get observation from simulator and calculate reward. The environment will
be set to ‘done’ only at success or failure. And if so, all visualizers will end. Its interfaces follow
the standard definition of <code class="docutils literal notranslate"><span class="pre">gym.Env</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>action (Dict): Action provided by policy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[Any, float, bool, Dict]: A tuple contains observation, reward, done and information.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="metadrivemacroenv">
<h2>MetaDriveMacroEnv<a class="headerlink" href="#metadrivemacroenv" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.envs.MetaDriveMacroEnv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.envs.</span></span><span class="sig-name descname"><span class="pre">MetaDriveMacroEnv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/envs/md_macro_env.html#MetaDriveMacroEnv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.MetaDriveMacroEnv" title="Permalink to this definition">¶</a></dt>
<dd><p>MetaDrive single-agent env controlled by a “macro” action. The agent is controlled by
a discrete action set. Each one related to a series of control signals that can complish
the macro action defined in the set. The observation is a top-down view image with 5 channel
containing the temporary and history information of surroundings. This env is registered
and can be used via <cite>gym.make</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>config (Dict): Env config dict.</p></li>
</ul>
</dd>
<dt class="field-even">Interfaces<span class="colon">:</span></dt>
<dd class="field-even"><p>reset, step, close, render, seed</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="metadrivetrajenv">
<h2>MetaDriveTrajEnv<a class="headerlink" href="#metadrivetrajenv" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.envs.MetaDriveTrajEnv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.envs.</span></span><span class="sig-name descname"><span class="pre">MetaDriveTrajEnv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/envs/md_traj_env.html#MetaDriveTrajEnv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.MetaDriveTrajEnv" title="Permalink to this definition">¶</a></dt>
<dd><p>MetaDrive single-agent trajectory env. The agent is controlled by a trajectory
(a list of waypoints) of a time period. Its length determines the times of env steps
the agent will track it. The vehicle will execute actions along the trajectory by ‘move_to’
method of the simulator rather than physical controlling. The position is calculated
from the trajectory with kinematic constraints before the vehicle is transmitted.
The observation is a 5-channel top-down view image and a vector of structure
information by default. This env is registered and can be used via <cite>gym.make</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>config (Dict): Env config dict.</p></li>
</ul>
</dd>
<dt class="field-even">Interfaces<span class="colon">:</span></dt>
<dd class="field-even"><p>reset, step, close, render, seed</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="driveenvwrapper">
<h2>DriveEnvWrapper<a class="headerlink" href="#driveenvwrapper" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.envs.DriveEnvWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.envs.</span></span><span class="sig-name descname"><span class="pre">DriveEnvWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.envs.BaseDriveEnv" title="core.envs.base_drive_env.BaseDriveEnv"><span class="pre">BaseDriveEnv</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/envs/drive_env_wrapper.html#DriveEnvWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.DriveEnvWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Environment wrapper to make <code class="docutils literal notranslate"><span class="pre">gym.Env</span></code> align with DI-engine definitions, so as to use utilities in DI-engine.
It changes <code class="docutils literal notranslate"><span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">reset</span></code> and <code class="docutils literal notranslate"><span class="pre">info</span></code> method of <code class="docutils literal notranslate"><span class="pre">gym.Env</span></code>, while others are straightly delivered.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>env (BaseDriveEnv): The environment to be wrapped.</p></li>
<li><p>cfg (Dict): Config dict.</p></li>
</ul>
</dd>
<dt class="field-even">Interfaces<span class="colon">:</span></dt>
<dd class="field-even"><p>reset, step, info, render, seed, close</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="core.envs.DriveEnvWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/core/envs/drive_env_wrapper.html#DriveEnvWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.DriveEnvWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper of <code class="docutils literal notranslate"><span class="pre">reset</span></code> method in env. The observations are converted to <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> and final reward
are recorded.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any: Observations from environment</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.DriveEnvWrapper.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/core/envs/drive_env_wrapper.html#DriveEnvWrapper.seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.DriveEnvWrapper.seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Seeds the environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.DriveEnvWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">BaseEnvTimestep</span></span></span><a class="reference internal" href="../_modules/core/envs/drive_env_wrapper.html#DriveEnvWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.DriveEnvWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper of <code class="docutils literal notranslate"><span class="pre">step</span></code> method in env. This aims to convert the returns of <code class="docutils literal notranslate"><span class="pre">gym.Env</span></code> step method into
that of <code class="docutils literal notranslate"><span class="pre">ding.envs.BaseEnv</span></code>, from <code class="docutils literal notranslate"><span class="pre">(obs,</span> <span class="pre">reward,</span> <span class="pre">done,</span> <span class="pre">info)</span></code> tuple to a <code class="docutils literal notranslate"><span class="pre">BaseEnvTimestep</span></code>
namedtuple defined in DI-engine. It will also convert actions, observations and reward into
<code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code>, and check legality if action contains control signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>action (Any, optional): Actions sent to env. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>BaseEnvTimestep: DI-engine format of env step returns.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="benchmarkenvwrapper">
<h2>BenchmarkEnvWrapper<a class="headerlink" href="#benchmarkenvwrapper" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.envs.BenchmarkEnvWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.envs.</span></span><span class="sig-name descname"><span class="pre">BenchmarkEnvWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#core.envs.BaseDriveEnv" title="core.envs.base_drive_env.BaseDriveEnv"><span class="pre">BaseDriveEnv</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/envs/drive_env_wrapper.html#BenchmarkEnvWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.BenchmarkEnvWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Environment Wrapper for Carla Benchmark suite evaluations. It wraps an environment with Benchmark
suite so that the env will always run with a benchmark suite setting. It has 2 mode to get reset
params in a suite: ‘random’ will randomly get reset param, ‘order’ will get all reset params in
order.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>env (BaseDriveEnv): The environment to be wrapped.</p></li>
<li><p>cfg (Dict): Config dict.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="core.envs.BenchmarkEnvWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/core/envs/drive_env_wrapper.html#BenchmarkEnvWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.BenchmarkEnvWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapped <code class="docutils literal notranslate"><span class="pre">reset</span></code> method for env. it will ignore all incoming arguments and choose one
from suite reset parameters according to config.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any: Returns of Env <cite>reset</cite> method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.envs.BenchmarkEnvWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/core/envs/drive_env_wrapper.html#BenchmarkEnvWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.envs.BenchmarkEnvWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapped <code class="docutils literal notranslate"><span class="pre">step</span></code> method for Env. It will add a print log when the env is done.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>action (Any): Actions sent to env.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Any: Env step result.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="policy.html" class="btn btn-neutral float-right" title="policy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="simulators.html" class="btn btn-neutral float-left" title="simulators" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, OpenDILab

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>