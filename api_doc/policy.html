

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>policy &mdash; DI-drive 0.3.4 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="models" href="models.html" />
    <link rel="prev" title="envs" href="envs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> DI-drive
          

          
          </a>

          
            
            
              <div class="version">
                0.3.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../features/index.html">Features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../model_zoo/index.html">Model Zoo</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Doc</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="simulators.html">simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="envs.html">envs</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">policy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basecarlapolicy">BaseCarlaPolicy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.policy.base_carla_policy.BaseCarlaPolicy"><code class="docutils literal notranslate"><span class="pre">BaseCarlaPolicy</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#autopidpolicy">AutoPIDPolicy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.policy.AutoPIDPolicy"><code class="docutils literal notranslate"><span class="pre">AutoPIDPolicy</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#autompcpolicy">AutoMPCPolicy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.policy.AutoMPCPolicy"><code class="docutils literal notranslate"><span class="pre">AutoMPCPolicy</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cilrspolicy">CILRSPolicy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.policy.CILRSPolicy"><code class="docutils literal notranslate"><span class="pre">CILRSPolicy</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lbcbirdviewpolicy">LBCBirdviewPolicy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.policy.LBCBirdviewPolicy"><code class="docutils literal notranslate"><span class="pre">LBCBirdviewPolicy</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lbcimagepolicy">LBCImagePolicy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#core.policy.LBCImagePolicy"><code class="docutils literal notranslate"><span class="pre">LBCImagePolicy</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="models.html">models</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">data</a></li>
<li class="toctree-l2"><a class="reference internal" href="eval.html">eval</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">utils</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DI-drive</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">API Doc</a> &raquo;</li>
        
      <li>policy</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api_doc/policy.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="policy">
<h1>policy<a class="headerlink" href="#policy" title="Permalink to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<section id="basecarlapolicy">
<h2>BaseCarlaPolicy<a class="headerlink" href="#basecarlapolicy" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.policy.base_carla_policy.BaseCarlaPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.policy.base_carla_policy.</span></span><span class="sig-name descname"><span class="pre">BaseCarlaPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/policy/base_carla_policy.html#BaseCarlaPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.base_carla_policy.BaseCarlaPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for Carla policy interact with environments. The policy is defined in standard DI-engine form which
has several modes to change its running form, and can interact with several environments controlled by a
<code class="docutils literal notranslate"><span class="pre">EnvManager</span></code>. The policy is designed to support Supervised Learning, Reinforcement Learning and other method
as well as expert policy, each may have different kinds of interfaces and modes.</p>
<p>By default, it has 3 modes: <cite>learn</cite>, <cite>collect</cite> and <cite>eval</cite>. To set policy to a specific mode, call the policy
with <code class="docutils literal notranslate"><span class="pre">policy.xxx_mode</span></code>. Then all the supported interfaces can be defined in <code class="docutils literal notranslate"><span class="pre">_interface_xxx</span></code> or <code class="docutils literal notranslate"><span class="pre">_interfaces</span></code>
method. For example, calling <code class="docutils literal notranslate"><span class="pre">policy.collect_mode.forward</span></code> is equal to calling <code class="docutils literal notranslate"><span class="pre">policy._forward_collect</span></code>.
Some mode-specific interfaces may be defined specially by user.</p>
<dl class="field-list simple">
<dt class="field-odd">Interfaces<span class="colon">:</span></dt>
<dd class="field-odd"><p>init, forward, reset, process_transition, get_train_sample</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="autopidpolicy">
<h2>AutoPIDPolicy<a class="headerlink" href="#autopidpolicy" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.policy.AutoPIDPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.policy.</span></span><span class="sig-name descname"><span class="pre">AutoPIDPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/policy/auto_policy.html#AutoPIDPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.AutoPIDPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Autonomous Driving policy follows target waypoint in env observations. It uses a Vehicle PID controller
for each env with a specific env id related to it. In each updating, all envs should use the correct env id
to make the PID controller works well, and the controller should be reset when starting a new episode.</p>
<p>The policy has 2 modes: <cite>collect</cite> and <cite>eval</cite>. Their interfaces operate in the same way. The only difference is
that in <cite>collect</cite> mode the <code class="docutils literal notranslate"><span class="pre">forward</span></code> method may add noises to steer if set in config.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>cfg (Dict): Config Dict.</p></li>
</ul>
</dd>
<dt class="field-even">Interfaces<span class="colon">:</span></dt>
<dd class="field-even"><p>reset, forward</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="core.policy.AutoPIDPolicy._forward_collect">
<span class="sig-name descname"><span class="pre">_forward_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../_modules/core/policy/auto_policy.html#AutoPIDPolicy._forward_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.AutoPIDPolicy._forward_collect" title="Permalink to this definition">¶</a></dt>
<dd><p>Running forward to get control signal of <cite>collect</cite> mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>data (Dict): Input dict, with env id in keys and related observations in values,</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict: Control dict stored in values for each provided env id.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.policy.AutoPIDPolicy._forward_eval">
<span class="sig-name descname"><span class="pre">_forward_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../_modules/core/policy/auto_policy.html#AutoPIDPolicy._forward_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.AutoPIDPolicy._forward_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Running forward to get control signal of <cite>eval</cite> mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>data (Dict): Input dict, with env id in keys and related observations in values,</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict: Control dict stored in values for each provided env id.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.policy.AutoPIDPolicy._reset_collect">
<span class="sig-name descname"><span class="pre">_reset_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/core/policy/auto_policy.html#AutoPIDPolicy._reset_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.AutoPIDPolicy._reset_collect" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset policy of <cite>collect</cite> mode. It will reset the controllers in provided env id. Noise will be add
to the controller according to config.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>data_id (List[int], optional): List of env id to reset. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.policy.AutoPIDPolicy._reset_eval">
<span class="sig-name descname"><span class="pre">_reset_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/core/policy/auto_policy.html#AutoPIDPolicy._reset_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.AutoPIDPolicy._reset_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset policy of <cite>eval</cite> mode. It will reset the controllers in providded env id.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>data_id (List[int], optional): List of env id to reset. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="autompcpolicy">
<h2>AutoMPCPolicy<a class="headerlink" href="#autompcpolicy" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.policy.AutoMPCPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.policy.</span></span><span class="sig-name descname"><span class="pre">AutoMPCPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/policy/auto_policy.html#AutoMPCPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.AutoMPCPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Autonomous Driving policy follows target waypoint list in env observations. It uses an MPC controller
for each env with a specific env id related to it. In each updating, all envs should use the correct
env id to make the MPC controller works well, and the controller should be reset when starting a new
episode.</p>
<p>The policy has 2 modes: <cite>collect</cite> and <cite>eval</cite>. Their interfaces operate in the same way. The only difference is
that in <cite>collect</cite> mode the <code class="docutils literal notranslate"><span class="pre">forward</span></code> method may add noises to steer if set in config.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>cfg (Dict): Config Dict.</p></li>
</ul>
</dd>
<dt class="field-even">Interfaces<span class="colon">:</span></dt>
<dd class="field-even"><p>reset, forward</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="core.policy.AutoMPCPolicy._forward_collect">
<span class="sig-name descname"><span class="pre">_forward_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../_modules/core/policy/auto_policy.html#AutoMPCPolicy._forward_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.AutoMPCPolicy._forward_collect" title="Permalink to this definition">¶</a></dt>
<dd><p>Running forward to get control signal of <cite>collect</cite> mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>data (Dict): Input dict, with env id in keys and related observations in values,</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict: Control dict stored in values for each provided env id.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.policy.AutoMPCPolicy._forward_eval">
<span class="sig-name descname"><span class="pre">_forward_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../_modules/core/policy/auto_policy.html#AutoMPCPolicy._forward_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.AutoMPCPolicy._forward_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Running forward to get control signal of <cite>eval</cite> mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>data (Dict): Input dict, with env id in keys and related observations in values,</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict: Control dict stored in values for each provided env id.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.policy.AutoMPCPolicy._reset_collect">
<span class="sig-name descname"><span class="pre">_reset_collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/core/policy/auto_policy.html#AutoMPCPolicy._reset_collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.AutoMPCPolicy._reset_collect" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset policy of <cite>collect</cite> mode. It will reset the controllers in provided env id. Noise will be add
to the controller according to config.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>data_id (List[int], optional): List of env id to reset. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.policy.AutoMPCPolicy._reset_eval">
<span class="sig-name descname"><span class="pre">_reset_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/core/policy/auto_policy.html#AutoMPCPolicy._reset_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.AutoMPCPolicy._reset_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset policy of <cite>eval</cite> mode. It will reset the controllers in providded env id.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>data_id (List[int], optional): List of env id to reset. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="cilrspolicy">
<h2>CILRSPolicy<a class="headerlink" href="#cilrspolicy" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.policy.CILRSPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.policy.</span></span><span class="sig-name descname"><span class="pre">CILRSPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['eval',</span> <span class="pre">'learn']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/policy/cilrs_policy.html#CILRSPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.CILRSPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>CILRS driving policy. It has a CILRS NN model which can handle
observations from several environments by collating data into batch. It contains 2
modes: <cite>eval</cite> and <cite>learn</cite>. The learn mode will calculate all losses, but will not
back-propregate it. In <cite>eval</cite> mode, the output control signal will be postprocessed to
standard control signal in Carla, and it can avoid stopping in the staring ticks.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>cfg (Dict): Config Dict.</p></li>
<li><p>enable_field(List): Enable policy filed, default to [‘eval’, ‘learn’]</p></li>
</ul>
</dd>
<dt class="field-even">Interfaces<span class="colon">:</span></dt>
<dd class="field-even"><p>reset, forward</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="lbcbirdviewpolicy">
<h2>LBCBirdviewPolicy<a class="headerlink" href="#lbcbirdviewpolicy" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.policy.LBCBirdviewPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.policy.</span></span><span class="sig-name descname"><span class="pre">LBCBirdviewPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['eval',</span> <span class="pre">'learn']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/policy/lbc_policy.html#LBCBirdviewPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.LBCBirdviewPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>LBC driving policy with Bird-eye View inputs. It has an LBC NN model which can handle
observations from several environments by collating data into batch. Each environment
has a PID controller related to it to get final control signals. In each updating, all
envs should use the correct env id to make the PID controller works well, and the
controller should be reset when starting a new episode.</p>
<p>It contains 2 modes: <cite>eval</cite> and <cite>learn</cite>. The learn mode will calculate all losses,
but will not back-propregate it. In <cite>eval</cite> mode, the output control signal will be
postprocessed to standard control signal in Carla.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>cfg (Dict): Config Dict.</p></li>
<li><p>enable_field(List): Enable policy filed, default to [‘eval’, ‘learn’]</p></li>
</ul>
</dd>
<dt class="field-even">Interfaces<span class="colon">:</span></dt>
<dd class="field-even"><p>reset, forward</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="core.policy.LBCBirdviewPolicy._forward_eval">
<span class="sig-name descname"><span class="pre">_forward_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/core/policy/lbc_policy.html#LBCBirdviewPolicy._forward_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.LBCBirdviewPolicy._forward_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Running forward to get control signal of <cite>eval</cite> mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>data (Dict): Input dict, with env id in keys and related observations in values,</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict: Control and waypoints dict stored in values for each provided env id.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.policy.LBCBirdviewPolicy._reset_eval">
<span class="sig-name descname"><span class="pre">_reset_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/core/policy/lbc_policy.html#LBCBirdviewPolicy._reset_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.LBCBirdviewPolicy._reset_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset policy of <cite>eval</cite> mode. It will change the NN model into ‘eval’ mode and reset
the controllers in provided env id.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>data_id (List[int], optional): List of env id to reset. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="lbcimagepolicy">
<h2>LBCImagePolicy<a class="headerlink" href="#lbcimagepolicy" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="core.policy.LBCImagePolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">core.policy.</span></span><span class="sig-name descname"><span class="pre">LBCImagePolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['eval',</span> <span class="pre">'learn']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/policy/lbc_policy.html#LBCImagePolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.LBCImagePolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>LBC driving policy with RGB image inputs. It has an LBC NN model which can handle
observations from several environments by collating data into batch. Each environment
has a PID controller related to it to get final control signals. In each updating, all
envs should use the correct env id to make the PID controller works well, and the
controller should be reset when starting a new episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>cfg (Dict): Config Dict.</p></li>
</ul>
</dd>
<dt class="field-even">Interfaces<span class="colon">:</span></dt>
<dd class="field-even"><p>reset, forward</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="core.policy.LBCImagePolicy._forward_eval">
<span class="sig-name descname"><span class="pre">_forward_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../_modules/core/policy/lbc_policy.html#LBCImagePolicy._forward_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.LBCImagePolicy._forward_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Running forward to get control signal of <cite>eval</cite> mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>data (Dict): Input dict, with env id in keys and related observations in values,</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict: Control and waypoints dict stored in values for each provided env id.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="core.policy.LBCImagePolicy._reset_eval">
<span class="sig-name descname"><span class="pre">_reset_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/core/policy/lbc_policy.html#LBCImagePolicy._reset_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#core.policy.LBCImagePolicy._reset_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset policy of <cite>eval</cite> mode. It will change the NN model into ‘eval’ mode and reset
the controllers in provided env id.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>data_id (List[int], optional): List of env id to reset. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="models.html" class="btn btn-neutral float-right" title="models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="envs.html" class="btn btn-neutral float-left" title="envs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, OpenDILab

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>