

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>from Continuous Intention to Continuous Trajectory &mdash; DI-drive 0.3.4 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="BeV Speed End-to-end Reinforcement Learning" href="simple_rl.html" />
    <link rel="prev" title="Learning by Cheating" href="lbc.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> DI-drive
          

          
          </a>

          
            
            
              <div class="version">
                0.3.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../features/index.html">Features</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Model Zoo</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#imitation-learning-model-zoo">Imitation Learning Model Zoo</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="cilrs.html">Conditional Imitation Learning</a></li>
<li class="toctree-l3"><a class="reference internal" href="lbc.html">Learning by Cheating</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">from Continuous Intention to Continuous Trajectory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#data-preparation">Data Preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#training">Training</a></li>
<li class="toctree-l4"><a class="reference internal" href="#evaluation">Evaluation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#results">Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="#benchmark-evaluating">Benchmark Evaluating</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#reinforcement-learning-model-zoo">Reinforcement Learning Model Zoo</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#other-method">Other Method</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_doc/index.html">API Doc</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DI-drive</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Model Zoo</a> &raquo;</li>
        
      <li>from Continuous Intention to Continuous Trajectory</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/model_zoo/cict.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="from-continuous-intention-to-continuous-trajectory">
<h1>from Continuous Intention to Continuous Trajectory<a class="headerlink" href="#from-continuous-intention-to-continuous-trajectory" title="Permalink to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<p><a class="reference external" href="https://arxiv.org/abs/2010.10393">from Continuous Intention to Continuous Trajectory(CICT)</a>
is a hierarchical Imitation Learning method for close-loop autonomous driving. It uses a generator
network to obtain potential map from RGB camera and LiDAR inputs, and then uses a trajectory function
network to generate a detailed trajectory together with the placement.</p>
<a class="reference internal image-reference" href="../_images/cict_1.png"><img alt="cict_1" class="align-center" src="../_images/cict_1.png" style="width: 800px;" /></a>
<p>DI-drive prepares training and evaluation for the GAN network and trajectory network in CICT. The IL
datasets is colleted via Carla. The close-loop control test is supported using the two trained networks.</p>
<section id="data-preparation">
<h2>Data Preparation<a class="headerlink" href="#data-preparation" title="Permalink to this heading">¶</a></h2>
<p>The collection settings can be modified in <code class="docutils literal notranslate"><span class="pre">demo/cict_demo/post.py</span></code>. By default we collect 40
episodes in total, 37 for training and 3 for evaluation.
You may need to change the environment num, episode num, server ip and port and dataset path
in default config before running.</p>
<p>Default settings:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">env</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">env_num</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">simulator</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">disable_two_wheels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">waypoint_num</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
            <span class="n">planner</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;behavior&#39;</span><span class="p">,</span>
                <span class="n">resolution</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">obs</span><span class="o">=</span><span class="p">(</span>
                <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;rgb&#39;</span><span class="p">,</span>
                    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;rgb&#39;</span><span class="p">,</span>
                    <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mi">640</span><span class="p">,</span> <span class="mi">360</span><span class="p">],</span>
                    <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span>
                    <span class="n">rotation</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="n">sensor_tick</span><span class="o">=</span><span class="mf">1.</span> <span class="o">/</span> <span class="mi">30</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;lidar&#39;</span><span class="p">,</span>
                    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;lidar&#39;</span><span class="p">,</span>
                    <span class="n">channels</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
                    <span class="nb">range</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                    <span class="n">points_per_second</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span>
                    <span class="n">rotation_frequency</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                    <span class="n">upper_fov</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                    <span class="n">lower_fov</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span>
                    <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span>
                    <span class="n">rotation</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="n">sensor_tick</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">col_is_failure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">stuck_is_failure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">manager</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">auto_reset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">shared_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">context</span><span class="o">=</span><span class="s1">&#39;spawn&#39;</span><span class="p">,</span>
            <span class="n">max_retry</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">wrapper</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">suite</span><span class="o">=</span><span class="s1">&#39;FullTown01-v3&#39;</span><span class="p">,</span> <span class="p">),</span>
    <span class="p">),</span>
    <span class="n">server</span><span class="o">=</span><span class="p">[</span>
        <span class="nb">dict</span><span class="p">(</span><span class="n">carla_host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">carla_ports</span><span class="o">=</span><span class="p">[</span><span class="mi">9000</span><span class="p">,</span> <span class="mi">9010</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
    <span class="p">],</span>
    <span class="n">policy</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">target_speed</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
        <span class="n">noise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">collect</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">n_episode</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
            <span class="n">dir_path</span><span class="o">=</span><span class="s1">&#39;datasets/cict_datasets_train&#39;</span><span class="p">,</span>
            <span class="n">npy_prefix</span><span class="o">=</span><span class="s1">&#39;_preloads&#39;</span><span class="p">,</span>
            <span class="n">collector</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">suite</span><span class="o">=</span><span class="s1">&#39;FullTown01-v3&#39;</span><span class="p">,</span> <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Collecting and post processing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python collect_data.py
</pre></div>
</div>
</section>
<section id="training">
<h2>Training<a class="headerlink" href="#training" title="Permalink to this heading">¶</a></h2>
<p>CICT is a two-stage method. <code class="docutils literal notranslate"><span class="pre">cict_train_GAN.py</span></code> and <code class="docutils literal notranslate"><span class="pre">cict_train_traj.py</span></code> are used for training of each stage.
You may need to change the dataset path and pre-train model path.</p>
<p>Default Configuration of the first stage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">NUMBER_OF_LOADING_WORKERS</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">IMG_HEIGHT</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
    <span class="n">IMG_WIDTH</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
    <span class="n">SENSORS</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">640</span><span class="p">]),</span>
    <span class="n">DEST</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="c1">#choose bird-view destination (0) or camera-view destination (1)</span>
    <span class="n">START_EPISODE</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="c1">#set which episodes for training</span>
    <span class="n">END_EPISODE</span><span class="o">=</span><span class="mi">37</span><span class="p">,</span>
    <span class="n">BATCH_SIZE</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">COMMON</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="s1">&#39;cict_GAN&#39;</span><span class="p">,</span> <span class="n">dataset_path</span><span class="o">=</span><span class="s1">&#39;datasets&#39;</span>
    <span class="p">),</span>
    <span class="n">GPU</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span>
    <span class="n">SAVE_INTERVAL</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">MAX_CKPT_SAVE_NUM</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">N_EPOCHS</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
    <span class="n">SPEED_FACTOR</span><span class="o">=</span><span class="mf">25.0</span><span class="p">,</span>
    <span class="n">TRAIN_DATASET_NAME</span><span class="o">=</span><span class="s1">&#39;cict_datasets_train&#39;</span><span class="p">,</span>
    <span class="n">MODEL_TYPE</span><span class="o">=</span><span class="s1">&#39;cict_GAN&#39;</span><span class="p">,</span>
    <span class="n">PREFIX</span><span class="o">=</span><span class="s1">&#39;_preloads&#39;</span><span class="p">,</span>
    <span class="n">UNPAIRED</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">GAN</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">MODEL_CONFIGURATION</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">generator</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">down_channels</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">],</span>
            <span class="n">up_channels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">],</span>
            <span class="n">kernel_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
            <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">down_norm</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
            <span class="n">up_norm</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
            <span class="n">down_dropout</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
            <span class="n">up_dropout</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">final_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">num_branches</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">discriminator</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">channels</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">],</span>
            <span class="n">kernel_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
            <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">norm</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
            <span class="n">dropout</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">),</span>
    <span class="n">PRE_TRAINED</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">LEARNING_RATE</span><span class="o">=</span><span class="mf">0.0003</span><span class="p">,</span>
    <span class="n">BETA1</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">BETA2</span><span class="o">=</span><span class="mf">0.999</span><span class="p">,</span>
    <span class="n">GAN_LOSS_FUNCTION</span><span class="o">=</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span>
    <span class="n">PIXEL_LOSS_FUNCTION</span><span class="o">=</span><span class="s1">&#39;L1&#39;</span><span class="p">,</span>
    <span class="n">PIXEL_LOSS_WEIGHT</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">PRELOAD_MODEL_ALIAS</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">PRELOAD_MODEL_BATCH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">PRELOAD_MODEL_CHECKPOINT</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">REMOVE</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Training the first stage:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python cict_train_GAN.py
</pre></div>
</div>
<p>Default Configuration of the second stage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">NUMBER_OF_LOADING_WORKERS</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">IMG_HEIGHT</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">IMG_WIDTH</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
    <span class="n">MAX_DIST</span><span class="o">=</span><span class="mf">25.</span><span class="p">,</span>
    <span class="n">MAX_T</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">IMG_STEP</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">PRED_LEN</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">START_EPISODE</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">END_EPISODE</span><span class="o">=</span><span class="mi">37</span><span class="p">,</span>
    <span class="n">BATCH_SIZE</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
    <span class="n">COMMON</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="s1">&#39;cict_traj&#39;</span><span class="p">,</span> <span class="n">dataset_path</span><span class="o">=</span><span class="s1">&#39;datasets&#39;</span>
    <span class="p">),</span>
    <span class="n">GPU</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span>
    <span class="n">EVAL</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">SAVE_INTERVAL</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">MAX_CKPT_SAVE_NUM</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">N_EPOCHS</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span>
    <span class="n">SPEED_FACTOR</span><span class="o">=</span><span class="mf">25.0</span><span class="p">,</span>
    <span class="n">TRAIN_DATASET_NAME</span><span class="o">=</span><span class="s1">&#39;cict_datasets_train&#39;</span><span class="p">,</span>
    <span class="n">MODEL_TYPE</span><span class="o">=</span><span class="s1">&#39;cict_traj&#39;</span><span class="p">,</span>
    <span class="n">PREFIX</span><span class="o">=</span><span class="s1">&#39;_preloads&#39;</span><span class="p">,</span>
    <span class="n">MODEL_CONFIGURATION</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">input_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">hidden_dim</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">out_dim</span><span class="o">=</span><span class="mi">2</span>
    <span class="p">),</span>
    <span class="n">PRE_TRAINED</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">LEARNING_RATE</span><span class="o">=</span><span class="mf">3e-4</span><span class="p">,</span>
    <span class="n">WEIGHT_DECAY</span><span class="o">=</span><span class="mf">5e-4</span><span class="p">,</span>
    <span class="n">VELOCITY_LOSS_WEIGHT</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ACCELERATION_LOSS_WEIGHT</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">PRELOAD_MODEL_ALIAS</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">PRELOAD_MODEL_BATCH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">PRELOAD_MODEL_CHECKPOINT</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">REMOVE</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Training the second stage:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python cict_train_traj.py
</pre></div>
</div>
</section>
<section id="evaluation">
<h2>Evaluation<a class="headerlink" href="#evaluation" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">cict_eval_GAN.py</span></code> and <code class="docutils literal notranslate"><span class="pre">cict_eval_traj.py</span></code> are used for training of each stage.
Note that you must evaluate the first stage before evaluate the second stage.
Also you may need to change the dataset path and pre-train weights path.</p>
<p>Default configuration of the first stage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">eval_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">NUMBER_OF_LOADING_WORKERS</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">IMG_HEIGHT</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
    <span class="n">IMG_WIDTH</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
    <span class="n">SENSORS</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">640</span><span class="p">]),</span>
    <span class="n">DEST</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">START_EPISODE</span><span class="o">=</span><span class="mi">37</span><span class="p">,</span>
    <span class="n">END_EPISODE</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">BATCH_SIZE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">COMMON</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="s1">&#39;cict_GAN&#39;</span><span class="p">,</span> <span class="n">dataset_path</span><span class="o">=</span><span class="s1">&#39;datasets&#39;</span>
    <span class="p">),</span>
    <span class="n">GPU</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span>
    <span class="n">TRAIN_DATASET_NAME</span><span class="o">=</span><span class="s1">&#39;cict_datasets_train&#39;</span><span class="p">,</span>
    <span class="n">MODEL_TYPE</span><span class="o">=</span><span class="s1">&#39;cict_GAN&#39;</span><span class="p">,</span>
    <span class="n">PREFIX</span><span class="o">=</span><span class="s1">&#39;_preloads&#39;</span><span class="p">,</span>
    <span class="n">UNPAIRED</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">MODEL_CONFIGURATION</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">generator</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">down_channels</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">],</span>
            <span class="n">up_channels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">],</span>
            <span class="n">kernel_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
            <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">down_norm</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
            <span class="n">up_norm</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
            <span class="n">down_dropout</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
            <span class="n">up_dropout</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">final_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">num_branches</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">),</span>
    <span class="n">GAN_LOSS_FUNCTION</span><span class="o">=</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span>
    <span class="n">PIXEL_LOSS_FUNCTION</span><span class="o">=</span><span class="s1">&#39;L1&#39;</span><span class="p">,</span>
    <span class="n">PRELOAD_MODEL_ALIAS</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">PRELOAD_MODEL_BATCH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">PRELOAD_MODEL_CHECKPOINT</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">REMOVE</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Evaluating the first stage:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python cict_eval_GAN.py
</pre></div>
</div>
<p>Default configuration of the second stage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">eval_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">NUMBER_OF_LOADING_WORKERS</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">IMG_HEIGHT</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">IMG_WIDTH</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
    <span class="n">MAX_DIST</span><span class="o">=</span><span class="mf">25.</span><span class="p">,</span>
    <span class="n">MAX_T</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">IMG_STEP</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">START_EPISODE</span><span class="o">=</span><span class="mi">37</span><span class="p">,</span>
    <span class="n">END_EPISODE</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
    <span class="n">BATCH_SIZE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">PRED_LEN</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">COMMON</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="s1">&#39;cict_traj&#39;</span><span class="p">,</span> <span class="n">dataset_path</span><span class="o">=</span><span class="s1">&#39;datasets&#39;</span>
    <span class="p">),</span>
    <span class="n">GPU</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span>
    <span class="n">SPEED_FACTOR</span><span class="o">=</span><span class="mf">25.0</span><span class="p">,</span>
    <span class="n">TRAIN_DATASET_NAME</span><span class="o">=</span><span class="s1">&#39;cict_datasets_train&#39;</span><span class="p">,</span>
    <span class="n">MODEL_TYPE</span><span class="o">=</span><span class="s1">&#39;cict_traj&#39;</span><span class="p">,</span>
    <span class="n">PREFIX</span><span class="o">=</span><span class="s1">&#39;_preloads&#39;</span><span class="p">,</span>
    <span class="n">EVAL</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">MODEL_CONFIGURATION</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">input_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">hidden_dim</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
        <span class="n">out_dim</span><span class="o">=</span><span class="mi">2</span>
    <span class="p">),</span>
    <span class="n">PRELOAD_MODEL_ALIAS</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">PRELOAD_MODEL_BATCH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">PRELOAD_MODEL_CHECKPOINT</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">REMOVE</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Evaluating the second stage:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python cict_eval_traj.py
</pre></div>
</div>
</section>
<section id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this heading">¶</a></h2>
<p>The ground-truth potential map and predicted potential map on evaluation dataset at the first stage:</p>
<img alt="result_GAN" class="align-center" src="../_images/result_GAN.png" />
<p>The MSE loss of position, velocity, and acceleration on evaluation dataset at the second stage:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>position loss</p></td>
<td><p>0.00024</p></td>
</tr>
<tr class="row-even"><td><p>velocity loss</p></td>
<td><p>0.44275</p></td>
</tr>
<tr class="row-odd"><td><p>acceleration loss</p></td>
<td><p>3.52583</p></td>
</tr>
</tbody>
</table>
<p>We provide pre-train weights under these configs. You can download it using this
<a class="reference external" href="http://opendilab.org/download/DI-drive/cict/il/">link</a></p>
</section>
<section id="benchmark-evaluating">
<h2>Benchmark Evaluating<a class="headerlink" href="#benchmark-evaluating" title="Permalink to this heading">¶</a></h2>
<p>The Benchmark evaluation runs with the two trained network in a Carla town suite. You may need to
change the environment num, server IP and port and suite’s name in config.</p>
<p>Default configuration:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">eval_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">env</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">env_num</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">simulator</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">disable_two_wheels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">waypoint_num</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
            <span class="n">obs</span><span class="o">=</span><span class="p">(</span>
                <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;rgb&#39;</span><span class="p">,</span>
                    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;rgb&#39;</span><span class="p">,</span>
                    <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mi">640</span><span class="p">,</span> <span class="mi">360</span><span class="p">],</span>
                    <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span>
                    <span class="n">rotation</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">),</span>
                <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;lidar&#39;</span><span class="p">,</span>
                    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;lidar&#39;</span><span class="p">,</span>
                    <span class="n">channels</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
                    <span class="nb">range</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                    <span class="n">points_per_second</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span>
                    <span class="n">rotation_frequency</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                    <span class="n">upper_fov</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                    <span class="n">lower_fov</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span>
                    <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span>
                    <span class="n">rotation</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="n">planner</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;behavior&#39;</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">col_is_failure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">stuck_is_failure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">manager</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">shared_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">auto_reset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">context</span><span class="o">=</span><span class="s1">&#39;spawn&#39;</span><span class="p">,</span>
            <span class="n">max_retry</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">),</span>
    <span class="n">server</span><span class="o">=</span><span class="p">[</span>
        <span class="nb">dict</span><span class="p">(</span><span class="n">carla_host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">carla_ports</span><span class="o">=</span><span class="p">[</span><span class="mi">9000</span><span class="p">,</span> <span class="mi">9010</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="p">],</span>
    <span class="n">policy</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">target_speed</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
        <span class="nb">eval</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">evaluator</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">suite</span><span class="o">=</span><span class="s1">&#39;FullTown01-v1&#39;</span><span class="p">,</span>
                <span class="n">episodes_per_suite</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                <span class="n">transform_obs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="n">policy_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">gan_ckpt_path</span><span class="o">=</span><span class="s1">&#39;_logs/sample/cict_GAN/checkpoints/3000.pth&#39;</span><span class="p">,</span>
        <span class="n">traj_ckpt_path</span><span class="o">=</span><span class="s1">&#39;_logs/sample/cict_traj/checkpoints/65000.pth&#39;</span>
    <span class="p">),</span>
    <span class="n">SAVE_DIR</span><span class="o">=</span><span class="s1">&#39;vis&#39;</span><span class="p">,</span>
    <span class="n">IMG_HEIGHT</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
    <span class="n">IMG_WIDTH</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
    <span class="n">SENSORS</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">640</span><span class="p">]),</span>
    <span class="n">DEST</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">SPEED_FACTOR</span><span class="o">=</span><span class="mf">25.0</span><span class="p">,</span>
    <span class="n">MODEL_CONFIGURATION</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">generator</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">down_channels</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">],</span>
            <span class="n">up_channels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">],</span>
            <span class="n">kernel_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
            <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">down_norm</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
            <span class="n">up_norm</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
            <span class="n">down_dropout</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
            <span class="n">up_dropout</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">final_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">num_branches</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">traj_model</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">input_dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">hidden_dim</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
            <span class="n">out_dim</span><span class="o">=</span><span class="mi">2</span>
        <span class="p">)</span>
    <span class="p">),</span>
    <span class="n">MAX_DIST</span><span class="o">=</span><span class="mf">25.</span><span class="p">,</span>
    <span class="n">MAX_T</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">IMG_STEP</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">PRED_LEN</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">DT</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">PRED_T</span><span class="o">=</span><span class="mi">3</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Evaluating on the Carla Benchmark:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python cict_eval.py
</pre></div>
</div>
<p>Testing with visualization:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">cict_test</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@ARTICLE</span><span class="p">{</span><span class="mi">9361054</span><span class="p">,</span>
    <span class="n">author</span><span class="o">=</span><span class="p">{</span><span class="n">Wang</span><span class="p">,</span> <span class="n">Yunkai</span> <span class="ow">and</span> <span class="n">Zhang</span><span class="p">,</span> <span class="n">Dongkun</span> <span class="ow">and</span> <span class="n">Wang</span><span class="p">,</span> <span class="n">Jingke</span> <span class="ow">and</span> <span class="n">Chen</span><span class="p">,</span> <span class="n">Zexi</span> <span class="ow">and</span> <span class="n">Li</span><span class="p">,</span> <span class="n">Yuehua</span> <span class="ow">and</span> <span class="n">Wang</span><span class="p">,</span> <span class="n">Yue</span> <span class="ow">and</span> <span class="n">Xiong</span><span class="p">,</span> <span class="n">Rong</span><span class="p">},</span>
    <span class="n">journal</span><span class="o">=</span><span class="p">{</span><span class="n">IEEE</span> <span class="n">Robotics</span> <span class="ow">and</span> <span class="n">Automation</span> <span class="n">Letters</span><span class="p">},</span>
    <span class="n">title</span><span class="o">=</span><span class="p">{</span><span class="n">Imitation</span> <span class="n">Learning</span> <span class="n">of</span> <span class="n">Hierarchical</span> <span class="n">Driving</span> <span class="n">Model</span><span class="p">:</span> <span class="n">From</span> <span class="n">Continuous</span> <span class="n">Intention</span> <span class="n">to</span> <span class="n">Continuous</span> <span class="n">Trajectory</span><span class="p">},</span>
    <span class="n">year</span><span class="o">=</span><span class="p">{</span><span class="mi">2021</span><span class="p">},</span>
    <span class="n">volume</span><span class="o">=</span><span class="p">{</span><span class="mi">6</span><span class="p">},</span>
    <span class="n">number</span><span class="o">=</span><span class="p">{</span><span class="mi">2</span><span class="p">},</span>
    <span class="n">pages</span><span class="o">=</span><span class="p">{</span><span class="mi">2477</span><span class="o">-</span><span class="mi">2484</span><span class="p">},</span>
    <span class="n">doi</span><span class="o">=</span><span class="p">{</span><span class="mf">10.1109</span><span class="o">/</span><span class="n">LRA</span><span class="mf">.2021.3061336</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="simple_rl.html" class="btn btn-neutral float-right" title="BeV Speed End-to-end Reinforcement Learning" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lbc.html" class="btn btn-neutral float-left" title="Learning by Cheating" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, OpenDILab

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>