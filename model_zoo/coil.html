

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Conditional Imitation Learning &mdash; DI-drive 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="End-to-End Model-Free Reinforcement Learning for Urban Driving using Implicit Affordances" href="implicit.html" />
    <link rel="prev" title="Model Zoo" href="index.html" />
    <link href="../_static/css/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> DI-drive
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../features/index.html">Features</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Model Zoo</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#imitation-learning-model-zoo">Imitation Learning Model Zoo</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Conditional Imitation Learning</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#data-collection">Data collection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model-training">Model training</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model-evaluation">Model evaluation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#reinforcement-learning-model-zoo">Reinforcement Learning Model Zoo</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#other-method">Other Method</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_doc/index.html">API Doc</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DI-drive</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Model Zoo</a> &raquo;</li>
        
      <li>Conditional Imitation Learning</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/model_zoo/coil.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="conditional-imitation-learning">
<span id="header-n32"></span><h1>Conditional Imitation Learning<a class="headerlink" href="#conditional-imitation-learning" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<p><a class="reference external" href="http://vladlen.info/papers/conditional-imitation.pdf">Conditional Imitation Learning(CIL)</a> is a
widely used imitation learning method for autoploit. The CIL takes front
RGB camera image and vehicle speed as inputs, then predict vehicle control
singals including steer, throttle and brake under certain navigation
command.</p>
<div class="figure align-center">
<img alt="image-cilrs_1" src="../_images/image-cils_1.png" />
</div>
<p>The CIL model use convolutional neural network to capture visual
information and concat it with measurements information (like
vehicle speed), then use the navigation command to select a suitable
branch to give prediction. More details about CIL can be found in the
paper.</p>
<div class="figure align-center">
<img alt="image-cilrs_2" src="../_images/image-cils_2.png" />
</div>
<p>DI-drive supports full pipeline of CIL, including datasets collecting, model
training, and benchmark evaluation. Quick start of CIL has been
introduced in the tutorial. All code in this page can be found in <code class="docutils literal notranslate"><span class="pre">./demo/coil_demo</span></code></p>
<div class="section" id="data-collection">
<span id="header-n66"></span><h2>Data collection<a class="headerlink" href="#data-collection" title="Permalink to this headline">¶</a></h2>
<p>The configuration of dataset collection has been set up in
<code class="docutils literal notranslate"><span class="pre">coil_data_collect.py.</span></code> You can custom it by
modifying the configuration.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">env</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">simulator</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">disable_two_wheels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">waypoint_num</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
            <span class="n">planner</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;behavior&#39;</span><span class="p">,</span>
                <span class="n">resolution</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">obs</span><span class="o">=</span><span class="p">(</span>
                <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;rgb&#39;</span><span class="p">,</span>
                    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;rgb&#39;</span><span class="p">,</span>
                    <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">],</span>
                    <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">],</span>
                    <span class="n">rotation</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">),</span>
            <span class="p">),</span>

        <span class="p">),</span>
        <span class="n">col_is_failure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">stuck_is_failure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">env_num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">episode_nums</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">env_manager</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">auto_reset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">shared_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">env_wrapper</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">suite</span><span class="o">=</span><span class="s1">&#39;FullTown01-v1&#39;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">collector</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">suite</span><span class="o">=</span><span class="s1">&#39;FullTown01-v1&#39;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">server</span><span class="o">=</span><span class="p">[</span>
        <span class="nb">dict</span><span class="p">(</span><span class="n">carla_host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">carla_ports</span><span class="o">=</span><span class="p">[</span><span class="mi">8000</span><span class="p">,</span> <span class="mi">8002</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
    <span class="p">],</span>
    <span class="n">policy</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">target_speed</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
        <span class="n">noise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">dir_path</span><span class="o">=</span><span class="s1">&#39;./datasets_train_collector/cils_datasets_train&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="model-training">
<span id="header-n75"></span><h2>Model training<a class="headerlink" href="#model-training" title="Permalink to this headline">¶</a></h2>
<p>The training of CIL is a standard imitation learning process. It takes
RGB image and measurement as input then mimic the export label. You can custom
the training by changing model architecture, learning rate, steps and so
on in <code class="docutils literal notranslate"><span class="pre">coil_train.py</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">NUMBER_OF_LOADING_WORKERS</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">SENSORS</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">200</span><span class="p">]),</span>
    <span class="n">TARGETS</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;steer&#39;</span><span class="p">,</span> <span class="s1">&#39;throttle&#39;</span><span class="p">,</span> <span class="s1">&#39;brake&#39;</span><span class="p">],</span>
    <span class="n">INPUTS</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;speed_module&#39;</span><span class="p">],</span>
    <span class="n">BATCH_SIZE</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span>
    <span class="n">COMMON</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="s1">&#39;coil_icra&#39;</span><span class="p">,</span> <span class="n">dataset_path</span><span class="o">=</span><span class="s1">&#39;./datasets_train&#39;</span>
    <span class="p">),</span>
    <span class="n">GPU</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span>
    <span class="n">SAVE_SCHEDULE</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000001</span><span class="p">],</span>
    <span class="n">NUMBER_ITERATIONS</span><span class="o">=</span><span class="mi">200000</span><span class="p">,</span>
    <span class="n">SPEED_FACTOR</span><span class="o">=</span><span class="mf">25.0</span><span class="p">,</span>
    <span class="n">TRAIN_DATASET_NAME</span><span class="o">=</span><span class="s1">&#39;cils_datasets_train&#39;</span><span class="p">,</span>
    <span class="n">AUGMENTATION</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">NUMBER_OF_HOURS</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">MODEL_TYPE</span><span class="o">=</span><span class="s1">&#39;coil-icra&#39;</span><span class="p">,</span>
    <span class="n">MODEL_CONFIGURATION</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">perception</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">res</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;resnet34&#39;</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">512</span><span class="p">)),</span>
        <span class="n">measurements</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fc</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">neurons</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">],</span> <span class="n">dropouts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])),</span>
        <span class="n">join</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fc</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">neurons</span><span class="o">=</span><span class="p">[</span><span class="mi">512</span><span class="p">],</span> <span class="n">dropouts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">])),</span>
        <span class="n">speed_branch</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fc</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">neurons</span><span class="o">=</span><span class="p">[</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">],</span> <span class="n">dropouts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])),</span>
        <span class="n">branches</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">number_of_branches</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">neurons</span><span class="o">=</span><span class="p">[</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">],</span> <span class="n">dropouts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]))</span>
    <span class="p">),</span>
    <span class="n">PRE_TRAINED</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">LEARNING_RATE_DECAY_INTERVAL</span><span class="o">=</span><span class="mi">75000</span><span class="p">,</span>
    <span class="n">LEARNING_RATE_DECAY_LEVEL</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">LEARNING_RATE_THRESHOLD</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
    <span class="n">LEARNING_RATE</span><span class="o">=</span><span class="mf">0.0002</span><span class="p">,</span>
    <span class="n">BRANCH_LOSS_WEIGHT</span><span class="o">=</span><span class="p">[</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span>
    <span class="n">VARIABLE_WEIGHT</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">Steer</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">Gas</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">Brake</span><span class="o">=</span><span class="mf">0.05</span><span class="p">),</span>
    <span class="n">LOSS_FUNCTION</span><span class="o">=</span><span class="s1">&#39;L1&#39;</span><span class="p">,</span>
    <span class="n">IMAGE_CUT</span><span class="o">=</span><span class="p">[</span><span class="mi">115</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
    <span class="n">PRELOAD_MODEL_ALIAS</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">PRELOAD_MODEL_BATCH</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">PRELOAD_MODEL_CHECKPOINT</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">REMOVE</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">NUMBER_IMAGES_SEQUENCE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">NUMBER_FRAMES_FUSION</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="model-evaluation">
<span id="header-n79"></span><h2>Model evaluation<a class="headerlink" href="#model-evaluation" title="Permalink to this headline">¶</a></h2>
<p>DI-drive supports model evaluation with Carla benchmark. To custom the
evaluation process, you can modify the configuration in <code class="docutils literal notranslate"><span class="pre">coil_eval.py</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">autoeval_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">env_num</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">env</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">simulator</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">obs</span><span class="o">=</span><span class="p">(</span>
                <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;rgb&#39;</span><span class="p">,</span>
                    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;rgb&#39;</span><span class="p">,</span>
                    <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mi">800</span><span class="p">,</span> <span class="mi">600</span><span class="p">],</span>
                    <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">],</span>
                    <span class="n">rotation</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">),</span> <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;birdview&#39;</span><span class="p">,</span>
                    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;bev&#39;</span><span class="p">,</span>
                    <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
                    <span class="n">pixels_per_meter</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="n">planner</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;behavior&#39;</span><span class="p">,</span> <span class="p">),</span>
        <span class="p">),</span>
    <span class="p">),</span>
    <span class="n">env_manager</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">shared_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">auto_reset</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">server</span><span class="o">=</span><span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">carla_host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">carla_ports</span><span class="o">=</span><span class="p">[</span><span class="mi">9000</span><span class="p">,</span> <span class="mi">9010</span><span class="p">,</span> <span class="mi">2</span><span class="p">])],</span>
    <span class="nb">eval</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">suite</span><span class="o">=</span><span class="s1">&#39;FullTown02-v1&#39;</span><span class="p">,</span>
        <span class="n">episodes_per_suite</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">policy</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">target_speed</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="p">),</span>
<span class="p">)</span>

<span class="n">policy_config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">ckpt_path</span><span class="o">=</span><span class="s1">&#39;./coil_icra/checkpoints/100.pth&#39;</span>
    <span class="p">),</span>
    <span class="n">SENSORS</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">200</span><span class="p">]),</span>
    <span class="n">TARGETS</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;steer&#39;</span><span class="p">,</span> <span class="s1">&#39;throttle&#39;</span><span class="p">,</span> <span class="s1">&#39;brake&#39;</span><span class="p">],</span>
    <span class="n">INPUTS</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;speed_module&#39;</span><span class="p">],</span>
    <span class="n">SPEED_FACTOR</span><span class="o">=</span><span class="mf">25.0</span><span class="p">,</span>
    <span class="n">MODEL_TYPE</span><span class="o">=</span><span class="s1">&#39;coil-icra&#39;</span><span class="p">,</span>
    <span class="n">MODEL_CONFIGURATION</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">perception</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">res</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;resnet34&#39;</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">512</span><span class="p">)),</span>
        <span class="n">measurements</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fc</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">neurons</span><span class="o">=</span><span class="p">[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">],</span> <span class="n">dropouts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])),</span>
        <span class="n">join</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fc</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">neurons</span><span class="o">=</span><span class="p">[</span><span class="mi">512</span><span class="p">],</span> <span class="n">dropouts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">])),</span>
        <span class="n">speed_branch</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fc</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">neurons</span><span class="o">=</span><span class="p">[</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">],</span> <span class="n">dropouts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])),</span>
        <span class="n">branches</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">number_of_branches</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">neurons</span><span class="o">=</span><span class="p">[</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">],</span> <span class="n">dropouts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]))</span>
    <span class="p">),</span>
    <span class="n">PRE_TRAINED</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">LEARNING_RATE_DECAY_LEVEL</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">IMAGE_CUT</span><span class="o">=</span><span class="p">[</span><span class="mi">115</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
    <span class="n">NUMBER_FRAMES_FUSION</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@inproceedings</span><span class="p">{</span><span class="mi">2018</span><span class="n">End</span><span class="p">,</span>
  <span class="n">title</span><span class="o">=</span><span class="p">{</span><span class="n">End</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">End</span> <span class="n">Driving</span> <span class="n">Via</span> <span class="n">Conditional</span> <span class="n">Imitation</span> <span class="n">Learning</span><span class="p">},</span>
  <span class="n">author</span><span class="o">=</span><span class="p">{</span> <span class="n">Codevilla</span><span class="p">,</span> <span class="n">Felipe</span>  <span class="ow">and</span>  <span class="n">Miiller</span><span class="p">,</span> <span class="n">Matthias</span>  <span class="ow">and</span>  <span class="n">Lopez</span><span class="p">,</span> <span class="n">Antonio</span>  <span class="ow">and</span>  <span class="n">Koltun</span><span class="p">,</span> <span class="n">Vladlen</span>  <span class="ow">and</span>  <span class="n">Dosovitskiy</span><span class="p">,</span> <span class="n">Alexey</span> <span class="p">},</span>
  <span class="n">booktitle</span><span class="o">=</span><span class="p">{</span><span class="mi">2018</span> <span class="n">IEEE</span> <span class="n">International</span> <span class="n">Conference</span> <span class="n">on</span> <span class="n">Robotics</span> <span class="ow">and</span> <span class="n">Automation</span> <span class="p">(</span><span class="n">ICRA</span><span class="p">)},</span>
  <span class="n">year</span><span class="o">=</span><span class="p">{</span><span class="mi">2018</span><span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="implicit.html" class="btn btn-neutral float-right" title="End-to-End Model-Free Reinforcement Learning for Urban Driving using Implicit Affordances" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Model Zoo" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, OpenDILab.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>